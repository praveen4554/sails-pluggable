[2017-12-06 11:00:21,776] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:21,777] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:21,777] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:21,779] TRACE [Controller id=0 epoch=89] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:21,781] ERROR [Controller id=0 epoch=89] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:00:21,783] TRACE [Controller id=0 epoch=89] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:21,784] ERROR [Controller id=0 epoch=89] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:00:21,785] TRACE [Controller id=0 epoch=89] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:21,787] ERROR [Controller id=0 epoch=89] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:00:26,777] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,777] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,777] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,778] TRACE [Controller id=0 epoch=89] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,779] TRACE [Controller id=0 epoch=89] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,780] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2017-12-06 11:00:26,781] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2017-12-06 11:00:26,781] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2017-12-06 11:00:26,782] TRACE [Controller id=0 epoch=89] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,782] TRACE [Controller id=0 epoch=89] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:00:26,782] TRACE [Controller id=0 epoch=89] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:00:26,782] TRACE [Controller id=0 epoch=89] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Controller id=0 epoch=89] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Controller id=0 epoch=89] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Controller id=0 epoch=89] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 89 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 89 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,783] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=0, zkVersion=87, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 89 for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,784] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition 789111199-0 since its associated leader epoch 87 is not higher than the current leader epoch 87 (state.change.logger)
[2017-12-06 11:00:26,784] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition 7891111-0 since its associated leader epoch 87 is not higher than the current leader epoch 87 (state.change.logger)
[2017-12-06 11:00:26,784] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition node-test-0 since its associated leader epoch 87 is not higher than the current leader epoch 87 (state.change.logger)
[2017-12-06 11:00:26,784] TRACE [Controller id=0 epoch=89] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,785] TRACE [Controller id=0 epoch=89] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,786] TRACE [Controller id=0 epoch=89] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,787] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2017-12-06 11:00:26,787] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2017-12-06 11:00:26,787] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=88, leader=0, leaderEpoch=87, isr=[0], zkVersion=87, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2017-12-06 11:00:26,788] TRACE [Controller id=0 epoch=89] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:00:26,788] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 89 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,788] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 89 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,788] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 89 for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,789] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,789] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,789] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,790] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition 789111199-0 (last update controller epoch 89) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:00:26,790] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition node-test-0 (last update controller epoch 89) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:00:26,791] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition 7891111-0 (last update controller epoch 89) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:00:26,791] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:00:26,791] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:00:26,791] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:00:26,791] TRACE [Controller id=0 epoch=89] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:00:26,792] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2017-12-06 11:00:26,792] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2017-12-06 11:00:26,792] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2017-12-06 11:00:26,793] TRACE [Controller id=0 epoch=89] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:03:26,229] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:26,230] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:26,231] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:26,237] TRACE [Controller id=0 epoch=90] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:26,245] ERROR [Controller id=0 epoch=90] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:03:26,252] TRACE [Controller id=0 epoch=90] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:26,254] ERROR [Controller id=0 epoch=90] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:03:26,255] TRACE [Controller id=0 epoch=90] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:26,256] ERROR [Controller id=0 epoch=90] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:03:31,093] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,093] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,093] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,094] TRACE [Controller id=0 epoch=90] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:03:31,094] TRACE [Controller id=0 epoch=90] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:03:31,095] TRACE [Controller id=0 epoch=90] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:03:31,095] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,095] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,095] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,096] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,096] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,097] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2017-12-06 11:03:31,097] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2017-12-06 11:03:31,097] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2017-12-06 11:03:31,097] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,097] TRACE [Controller id=0 epoch=90] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,099] TRACE [Controller id=0 epoch=90] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,099] TRACE [Controller id=0 epoch=90] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:03:31,100] TRACE [Controller id=0 epoch=90] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:03:31,100] TRACE [Controller id=0 epoch=90] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 90 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Controller id=0 epoch=90] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 90 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=0, zkVersion=88, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 90 for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Controller id=0 epoch=90] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:03:31,101] TRACE [Controller id=0 epoch=90] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,102] TRACE [Controller id=0 epoch=90] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,102] TRACE [Controller id=0 epoch=90] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:03:31,102] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,102] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,102] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition 789111199-0 since its associated leader epoch 88 is not higher than the current leader epoch 88 (state.change.logger)
[2017-12-06 11:03:31,102] TRACE [Controller id=0 epoch=90] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,103] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition 7891111-0 since its associated leader epoch 88 is not higher than the current leader epoch 88 (state.change.logger)
[2017-12-06 11:03:31,103] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,103] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition node-test-0 since its associated leader epoch 88 is not higher than the current leader epoch 88 (state.change.logger)
[2017-12-06 11:03:31,103] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,103] TRACE [Controller id=0 epoch=90] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,104] TRACE [Controller id=0 epoch=90] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:03:31,104] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2017-12-06 11:03:31,104] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2017-12-06 11:03:31,104] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=89, leader=0, leaderEpoch=88, isr=[0], zkVersion=88, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2017-12-06 11:03:31,105] TRACE [Controller id=0 epoch=90] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:03:31,105] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 90 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,105] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 90 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,105] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 90 for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,106] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,106] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,106] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,107] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition 789111199-0 (last update controller epoch 90) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:03:31,107] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition node-test-0 (last update controller epoch 90) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:03:31,108] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition 7891111-0 (last update controller epoch 90) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:03:31,108] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:03:31,108] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:03:31,108] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:03:31,108] TRACE [Controller id=0 epoch=90] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:03:31,109] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2017-12-06 11:03:31,109] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2017-12-06 11:03:31,109] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2017-12-06 11:03:31,110] TRACE [Controller id=0 epoch=90] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:11:59,644] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:11:59,644] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:11:59,644] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:11:59,645] TRACE [Controller id=0 epoch=91] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:11:59,648] ERROR [Controller id=0 epoch=91] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:11:59,651] TRACE [Controller id=0 epoch=91] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:11:59,652] ERROR [Controller id=0 epoch=91] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:11:59,652] TRACE [Controller id=0 epoch=91] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:11:59,653] ERROR [Controller id=0 epoch=91] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:12:04,631] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,632] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,632] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,633] TRACE [Controller id=0 epoch=91] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Controller id=0 epoch=91] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Controller id=0 epoch=91] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,634] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,635] TRACE [Controller id=0 epoch=91] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,636] TRACE [Controller id=0 epoch=91] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:12:04,637] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 91 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,638] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 91 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,638] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=0, zkVersion=89, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 91 for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,638] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition 789111199-0 since its associated leader epoch 89 is not higher than the current leader epoch 89 (state.change.logger)
[2017-12-06 11:12:04,638] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition 7891111-0 since its associated leader epoch 89 is not higher than the current leader epoch 89 (state.change.logger)
[2017-12-06 11:12:04,638] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition node-test-0 since its associated leader epoch 89 is not higher than the current leader epoch 89 (state.change.logger)
[2017-12-06 11:12:04,638] TRACE [Controller id=0 epoch=91] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,638] TRACE [Controller id=0 epoch=91] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:12:04,638] TRACE [Controller id=0 epoch=91] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,639] TRACE [Controller id=0 epoch=91] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:12:04,641] TRACE [Controller id=0 epoch=91] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,641] TRACE [Controller id=0 epoch=91] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:12:04,642] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2017-12-06 11:12:04,642] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2017-12-06 11:12:04,643] TRACE [Controller id=0 epoch=91] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,643] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=90, leader=0, leaderEpoch=89, isr=[0], zkVersion=89, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2017-12-06 11:12:04,643] TRACE [Controller id=0 epoch=91] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:12:04,644] TRACE [Controller id=0 epoch=91] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,645] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,646] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 91 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,646] TRACE [Controller id=0 epoch=91] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,646] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 91 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,646] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 91 for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,647] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,647] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,647] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,649] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition 789111199-0 (last update controller epoch 91) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:12:04,649] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition node-test-0 (last update controller epoch 91) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:12:04,649] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition 7891111-0 (last update controller epoch 91) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:12:04,649] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Controller id=0 epoch=91] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2017-12-06 11:12:04,650] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2017-12-06 11:12:04,651] TRACE [Controller id=0 epoch=91] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:18:33,189] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:33,190] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:33,190] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:33,193] TRACE [Controller id=0 epoch=92] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:33,199] ERROR [Controller id=0 epoch=92] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:18:33,204] TRACE [Controller id=0 epoch=92] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:33,206] ERROR [Controller id=0 epoch=92] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:18:33,224] TRACE [Controller id=0 epoch=92] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:33,227] ERROR [Controller id=0 epoch=92] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:18:38,135] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,135] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,136] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,137] TRACE [Controller id=0 epoch=92] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,138] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2017-12-06 11:18:38,139] TRACE [Controller id=0 epoch=92] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,139] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2017-12-06 11:18:38,139] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2017-12-06 11:18:38,140] TRACE [Controller id=0 epoch=92] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:18:38,141] TRACE [Controller id=0 epoch=92] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,141] TRACE [Controller id=0 epoch=92] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:18:38,141] TRACE [Controller id=0 epoch=92] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,141] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 92 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,142] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 92 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,142] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=0, zkVersion=90, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 92 for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,142] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition 789111199-0 since its associated leader epoch 90 is not higher than the current leader epoch 90 (state.change.logger)
[2017-12-06 11:18:38,142] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition 7891111-0 since its associated leader epoch 90 is not higher than the current leader epoch 90 (state.change.logger)
[2017-12-06 11:18:38,142] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition node-test-0 since its associated leader epoch 90 is not higher than the current leader epoch 90 (state.change.logger)
[2017-12-06 11:18:38,142] TRACE [Controller id=0 epoch=92] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,143] TRACE [Controller id=0 epoch=92] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:18:38,143] TRACE [Controller id=0 epoch=92] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,143] TRACE [Controller id=0 epoch=92] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=91, leader=0, leaderEpoch=90, isr=[0], zkVersion=90, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2017-12-06 11:18:38,144] TRACE [Controller id=0 epoch=92] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 92 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 92 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 92 for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,145] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,146] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition 789111199-0 (last update controller epoch 92) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:18:38,146] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition node-test-0 (last update controller epoch 92) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:18:38,147] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition 7891111-0 (last update controller epoch 92) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Controller id=0 epoch=92] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2017-12-06 11:18:38,147] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2017-12-06 11:18:38,148] TRACE [Controller id=0 epoch=92] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:24:40,819] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:40,820] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:40,820] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:40,822] TRACE [Controller id=0 epoch=93] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:40,826] ERROR [Controller id=0 epoch=93] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:24:40,829] TRACE [Controller id=0 epoch=93] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:40,830] ERROR [Controller id=0 epoch=93] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:24:40,836] TRACE [Controller id=0 epoch=93] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:40,837] ERROR [Controller id=0 epoch=93] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:24:45,803] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,804] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,804] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,806] TRACE [Controller id=0 epoch=93] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:24:45,807] TRACE [Controller id=0 epoch=93] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:24:45,807] TRACE [Controller id=0 epoch=93] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:24:45,808] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,808] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,809] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,809] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2017-12-06 11:24:45,809] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,809] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2017-12-06 11:24:45,810] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,810] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2017-12-06 11:24:45,810] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,810] TRACE [Controller id=0 epoch=93] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,811] TRACE [Controller id=0 epoch=93] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Controller id=0 epoch=93] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Controller id=0 epoch=93] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Controller id=0 epoch=93] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 93 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 93 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,812] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=0, zkVersion=91, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 93 for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,813] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition 789111199-0 since its associated leader epoch 91 is not higher than the current leader epoch 91 (state.change.logger)
[2017-12-06 11:24:45,813] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition 7891111-0 since its associated leader epoch 91 is not higher than the current leader epoch 91 (state.change.logger)
[2017-12-06 11:24:45,813] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition node-test-0 since its associated leader epoch 91 is not higher than the current leader epoch 91 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Controller id=0 epoch=93] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Controller id=0 epoch=93] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Controller id=0 epoch=93] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Controller id=0 epoch=93] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,814] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=92, leader=0, leaderEpoch=91, isr=[0], zkVersion=91, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2017-12-06 11:24:45,815] TRACE [Controller id=0 epoch=93] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:24:45,815] TRACE [Controller id=0 epoch=93] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Controller id=0 epoch=93] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,816] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 93 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,817] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 93 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,818] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 93 for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,818] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,818] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,818] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,820] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition 789111199-0 (last update controller epoch 93) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:24:45,820] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition node-test-0 (last update controller epoch 93) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:24:45,820] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition 7891111-0 (last update controller epoch 93) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:24:45,820] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:24:45,820] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:24:45,820] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:24:45,822] TRACE [Controller id=0 epoch=93] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:24:45,823] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2017-12-06 11:24:45,823] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2017-12-06 11:24:45,823] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2017-12-06 11:24:45,823] TRACE [Controller id=0 epoch=93] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:30:00,352] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:00,353] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:00,353] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:00,355] TRACE [Controller id=0 epoch=94] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:00,363] ERROR [Controller id=0 epoch=94] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:30:00,366] TRACE [Controller id=0 epoch=94] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:00,369] ERROR [Controller id=0 epoch=94] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:30:00,376] TRACE [Controller id=0 epoch=94] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:00,387] ERROR [Controller id=0 epoch=94] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:30:05,308] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,308] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,308] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,309] TRACE [Controller id=0 epoch=94] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:30:05,310] TRACE [Controller id=0 epoch=94] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:30:05,310] TRACE [Controller id=0 epoch=94] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:30:05,311] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,311] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,311] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,311] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,312] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,312] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,312] TRACE [Controller id=0 epoch=94] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,313] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2017-12-06 11:30:05,313] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2017-12-06 11:30:05,313] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2017-12-06 11:30:05,314] TRACE [Controller id=0 epoch=94] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,314] TRACE [Controller id=0 epoch=94] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:30:05,314] TRACE [Controller id=0 epoch=94] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,314] TRACE [Controller id=0 epoch=94] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:30:05,315] TRACE [Controller id=0 epoch=94] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,315] TRACE [Controller id=0 epoch=94] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:30:05,315] TRACE [Controller id=0 epoch=94] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,317] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 94 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,318] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 94 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,319] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=0, zkVersion=92, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 94 for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,320] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition 789111199-0 since its associated leader epoch 92 is not higher than the current leader epoch 92 (state.change.logger)
[2017-12-06 11:30:05,320] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition 7891111-0 since its associated leader epoch 92 is not higher than the current leader epoch 92 (state.change.logger)
[2017-12-06 11:30:05,320] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition node-test-0 since its associated leader epoch 92 is not higher than the current leader epoch 92 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,320] TRACE [Controller id=0 epoch=94] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,322] TRACE [Controller id=0 epoch=94] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:30:05,325] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2017-12-06 11:30:05,325] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2017-12-06 11:30:05,325] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=93, leader=0, leaderEpoch=92, isr=[0], zkVersion=92, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2017-12-06 11:30:05,326] TRACE [Controller id=0 epoch=94] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:30:05,327] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 94 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,327] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 94 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,327] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 94 for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,327] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,328] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,328] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,330] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition 789111199-0 (last update controller epoch 94) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:30:05,331] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition node-test-0 (last update controller epoch 94) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:30:05,331] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition 7891111-0 (last update controller epoch 94) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:30:05,331] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:30:05,331] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:30:05,331] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:30:05,332] TRACE [Controller id=0 epoch=94] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:30:05,334] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2017-12-06 11:30:05,334] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2017-12-06 11:30:05,334] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2017-12-06 11:30:05,334] TRACE [Controller id=0 epoch=94] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:39:50,013] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:50,014] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:50,015] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:50,017] TRACE [Controller id=0 epoch=95] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:50,023] ERROR [Controller id=0 epoch=95] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:39:50,027] TRACE [Controller id=0 epoch=95] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:50,028] ERROR [Controller id=0 epoch=95] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:39:50,033] TRACE [Controller id=0 epoch=95] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:50,034] ERROR [Controller id=0 epoch=95] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:39:54,955] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,955] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,955] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,957] TRACE [Controller id=0 epoch=95] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,958] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 0 (state.change.logger)
[2017-12-06 11:39:54,958] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 0 (state.change.logger)
[2017-12-06 11:39:54,958] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 0 (state.change.logger)
[2017-12-06 11:39:54,959] TRACE [Controller id=0 epoch=95] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,959] TRACE [Controller id=0 epoch=95] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:39:54,959] TRACE [Controller id=0 epoch=95] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,959] TRACE [Controller id=0 epoch=95] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Controller id=0 epoch=95] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Controller id=0 epoch=95] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Controller id=0 epoch=95] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 95 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 95 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,960] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=0, zkVersion=93, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 95 for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,960] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 95 for partition 789111199-0 since its associated leader epoch 93 is not higher than the current leader epoch 93 (state.change.logger)
[2017-12-06 11:39:54,960] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 95 for partition 7891111-0 since its associated leader epoch 93 is not higher than the current leader epoch 93 (state.change.logger)
[2017-12-06 11:39:54,960] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 95 for partition node-test-0 since its associated leader epoch 93 is not higher than the current leader epoch 93 (state.change.logger)
[2017-12-06 11:39:54,961] TRACE [Controller id=0 epoch=95] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,961] TRACE [Controller id=0 epoch=95] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:39:54,961] TRACE [Controller id=0 epoch=95] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:39:54,961] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Controller id=0 epoch=95] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Controller id=0 epoch=95] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 2 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 2 (state.change.logger)
[2017-12-06 11:39:54,962] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=94, leader=0, leaderEpoch=93, isr=[0], zkVersion=93, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 2 (state.change.logger)
[2017-12-06 11:39:54,963] TRACE [Controller id=0 epoch=95] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 95 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 95 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 95 for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 95 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 95 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,964] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 95 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,966] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 95 for partition 789111199-0 (last update controller epoch 95) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:39:54,966] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 95 for partition node-test-0 (last update controller epoch 95) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:39:54,966] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 95 for partition 7891111-0 (last update controller epoch 95) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:39:54,966] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 95 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:39:54,966] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 95 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:39:54,966] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 95 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:39:54,966] TRACE [Controller id=0 epoch=95] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:39:54,967] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 4 (state.change.logger)
[2017-12-06 11:39:54,967] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 4 (state.change.logger)
[2017-12-06 11:39:54,967] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 95 with correlation id 4 (state.change.logger)
[2017-12-06 11:39:54,967] TRACE [Controller id=0 epoch=95] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:46:42,559] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:42,559] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:42,559] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:42,563] TRACE [Controller id=0 epoch=96] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:42,567] ERROR [Controller id=0 epoch=96] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:46:42,570] TRACE [Controller id=0 epoch=96] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:42,572] ERROR [Controller id=0 epoch=96] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:46:42,575] TRACE [Controller id=0 epoch=96] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:42,576] ERROR [Controller id=0 epoch=96] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:46:47,540] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,541] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,541] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,545] TRACE [Controller id=0 epoch=96] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:46:47,546] TRACE [Controller id=0 epoch=96] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:46:47,546] TRACE [Controller id=0 epoch=96] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:46:47,546] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,546] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,546] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,547] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,547] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,547] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,548] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 0 (state.change.logger)
[2017-12-06 11:46:47,548] TRACE [Controller id=0 epoch=96] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,549] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 0 (state.change.logger)
[2017-12-06 11:46:47,549] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 0 (state.change.logger)
[2017-12-06 11:46:47,551] TRACE [Controller id=0 epoch=96] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:46:47,552] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 96 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,552] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 96 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,552] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=0, zkVersion=94, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 96 for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,552] TRACE [Controller id=0 epoch=96] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,553] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 96 for partition 789111199-0 since its associated leader epoch 94 is not higher than the current leader epoch 94 (state.change.logger)
[2017-12-06 11:46:47,553] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 96 for partition 7891111-0 since its associated leader epoch 94 is not higher than the current leader epoch 94 (state.change.logger)
[2017-12-06 11:46:47,553] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 96 for partition node-test-0 since its associated leader epoch 94 is not higher than the current leader epoch 94 (state.change.logger)
[2017-12-06 11:46:47,553] TRACE [Controller id=0 epoch=96] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:46:47,554] TRACE [Controller id=0 epoch=96] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,555] TRACE [Controller id=0 epoch=96] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:46:47,556] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 2 (state.change.logger)
[2017-12-06 11:46:47,556] TRACE [Controller id=0 epoch=96] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,557] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 2 (state.change.logger)
[2017-12-06 11:46:47,557] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=95, leader=0, leaderEpoch=94, isr=[0], zkVersion=94, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 2 (state.change.logger)
[2017-12-06 11:46:47,557] TRACE [Controller id=0 epoch=96] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:46:47,558] TRACE [Controller id=0 epoch=96] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,558] TRACE [Controller id=0 epoch=96] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:46:47,560] TRACE [Controller id=0 epoch=96] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,560] TRACE [Controller id=0 epoch=96] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,561] TRACE [Controller id=0 epoch=96] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,564] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 96 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,564] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 96 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,564] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 96 for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,565] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 96 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,566] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 96 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,566] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 96 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,574] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 96 for partition 789111199-0 (last update controller epoch 96) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:46:47,574] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 96 for partition node-test-0 (last update controller epoch 96) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:46:47,575] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 96 for partition 7891111-0 (last update controller epoch 96) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:46:47,575] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 96 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:46:47,575] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 96 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:46:47,575] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 96 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:46:47,576] TRACE [Controller id=0 epoch=96] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:46:47,576] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 4 (state.change.logger)
[2017-12-06 11:46:47,576] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 4 (state.change.logger)
[2017-12-06 11:46:47,576] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 96 with correlation id 4 (state.change.logger)
[2017-12-06 11:46:47,577] TRACE [Controller id=0 epoch=96] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:52:54,450] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:54,450] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:54,450] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:54,452] TRACE [Controller id=0 epoch=97] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:54,454] ERROR [Controller id=0 epoch=97] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:52:54,461] TRACE [Controller id=0 epoch=97] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:54,462] ERROR [Controller id=0 epoch=97] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:52:54,463] TRACE [Controller id=0 epoch=97] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:54,467] ERROR [Controller id=0 epoch=97] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:52:59,453] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,453] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,453] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,455] TRACE [Controller id=0 epoch=97] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:52:59,456] TRACE [Controller id=0 epoch=97] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Controller id=0 epoch=97] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 0 (state.change.logger)
[2017-12-06 11:52:59,459] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 0 (state.change.logger)
[2017-12-06 11:52:59,460] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,460] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,460] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,460] TRACE [Controller id=0 epoch=97] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,461] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 0 (state.change.logger)
[2017-12-06 11:52:59,462] TRACE [Controller id=0 epoch=97] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 97 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 97 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Controller id=0 epoch=97] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Controller id=0 epoch=97] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Controller id=0 epoch=97] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,463] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=0, zkVersion=95, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 97 for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,464] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 97 for partition 789111199-0 since its associated leader epoch 95 is not higher than the current leader epoch 95 (state.change.logger)
[2017-12-06 11:52:59,464] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 97 for partition 7891111-0 since its associated leader epoch 95 is not higher than the current leader epoch 95 (state.change.logger)
[2017-12-06 11:52:59,464] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 97 for partition node-test-0 since its associated leader epoch 95 is not higher than the current leader epoch 95 (state.change.logger)
[2017-12-06 11:52:59,465] TRACE [Controller id=0 epoch=97] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,465] TRACE [Controller id=0 epoch=97] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:52:59,465] TRACE [Controller id=0 epoch=97] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:52:59,466] TRACE [Controller id=0 epoch=97] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,468] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 2 (state.change.logger)
[2017-12-06 11:52:59,468] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 2 (state.change.logger)
[2017-12-06 11:52:59,468] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=96, leader=0, leaderEpoch=95, isr=[0], zkVersion=95, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 2 (state.change.logger)
[2017-12-06 11:52:59,468] TRACE [Controller id=0 epoch=97] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:52:59,469] TRACE [Controller id=0 epoch=97] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,471] TRACE [Controller id=0 epoch=97] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:52:59,471] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,472] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,473] TRACE [Controller id=0 epoch=97] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,473] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,474] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,475] TRACE [Controller id=0 epoch=97] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,475] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 97 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,476] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 97 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,476] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 97 for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,476] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 97 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,476] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 97 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,476] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 97 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,478] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 97 for partition 789111199-0 (last update controller epoch 97) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:52:59,478] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 97 for partition node-test-0 (last update controller epoch 97) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:52:59,478] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 97 for partition 7891111-0 (last update controller epoch 97) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:52:59,478] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 97 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:52:59,478] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 97 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:52:59,478] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 97 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:52:59,479] TRACE [Controller id=0 epoch=97] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:52:59,479] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 4 (state.change.logger)
[2017-12-06 11:52:59,479] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 4 (state.change.logger)
[2017-12-06 11:52:59,480] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 97 with correlation id 4 (state.change.logger)
[2017-12-06 11:52:59,481] TRACE [Controller id=0 epoch=97] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:58:13,694] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:13,694] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:13,694] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[0]) to brokers Set() for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:13,696] TRACE [Controller id=0 epoch=98] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:13,699] ERROR [Controller id=0 epoch=98] Initiated state change for partition 789111199-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 789111199-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:58:13,702] TRACE [Controller id=0 epoch=98] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:13,704] ERROR [Controller id=0 epoch=98] Initiated state change for partition 7891111-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition 7891111-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:58:13,707] TRACE [Controller id=0 epoch=98] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:13,707] ERROR [Controller id=0 epoch=98] Initiated state change for partition node-test-0 from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica in ISR for partition node-test-0 is alive. Live brokers are: [Set()], ISR brokers are: [0]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:67)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	at kafka.controller.PartitionStateMachine.handleStateChange(PartitionStateMachine.scala:163)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3(PartitionStateMachine.scala:85)
	at kafka.controller.PartitionStateMachine.$anonfun$triggerOnlinePartitionStateChange$3$adapted(PartitionStateMachine.scala:81)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:789)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:138)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:236)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:229)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:138)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:788)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:81)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:298)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1681)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2017-12-06 11:58:18,685] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,685] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,685] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,687] TRACE [Controller id=0 epoch=98] Changed state of replica 0 for partition 789111199-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:58:18,687] TRACE [Controller id=0 epoch=98] Changed state of replica 0 for partition node-test-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Controller id=0 epoch=98] Changed state of replica 0 for partition 7891111-0 from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 0 (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 0 (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 0 (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,688] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,689] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,689] TRACE [Controller id=0 epoch=98] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:58:18,690] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,690] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 98 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,690] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 98 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,690] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,690] TRACE [Controller id=0 epoch=98] Started leader election for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,691] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=0, zkVersion=96, replicas=0, isNew=false) correlation id 1 from controller 0 epoch 98 for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,692] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 98 for partition 789111199-0 since its associated leader epoch 96 is not higher than the current leader epoch 96 (state.change.logger)
[2017-12-06 11:58:18,693] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 98 for partition 7891111-0 since its associated leader epoch 96 is not higher than the current leader epoch 96 (state.change.logger)
[2017-12-06 11:58:18,693] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 98 for partition node-test-0 since its associated leader epoch 96 is not higher than the current leader epoch 96 (state.change.logger)
[2017-12-06 11:58:18,693] TRACE [Controller id=0 epoch=98] Elected leader 0 for Offline partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,693] TRACE [Controller id=0 epoch=98] Changed partition 789111199-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:58:18,694] TRACE [Controller id=0 epoch=98] Started leader election for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,696] TRACE [Controller id=0 epoch=98] Elected leader 0 for Offline partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,696] TRACE [Controller id=0 epoch=98] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=11},{topic=7891111,partition=0,error_code=11},{topic=node-test,partition=0,error_code=11}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:58:18,697] TRACE [Controller id=0 epoch=98] Changed partition 7891111-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:58:18,697] TRACE [Controller id=0 epoch=98] Started leader election for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,699] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 2 (state.change.logger)
[2017-12-06 11:58:18,699] TRACE [Controller id=0 epoch=98] Elected leader 0 for Offline partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,699] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 2 (state.change.logger)
[2017-12-06 11:58:18,699] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=97, leader=0, leaderEpoch=96, isr=[0], zkVersion=96, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 2 (state.change.logger)
[2017-12-06 11:58:18,699] TRACE [Controller id=0 epoch=98] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:58:18,700] TRACE [Controller id=0 epoch=98] Changed partition node-test-0 from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 11:58:18,700] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) to broker 0 for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,701] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) to broker 0 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,702] TRACE [Controller id=0 epoch=98] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) to broker 0 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,702] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,702] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,703] TRACE [Controller id=0 epoch=98] Sending UpdateMetadata request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) to brokers Set(0) for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,704] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 98 for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,705] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 98 for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,705] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=0, zkVersion=97, replicas=0, isNew=false) correlation id 3 from controller 0 epoch 98 for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,706] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 98 starting the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,707] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 98 starting the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,707] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 epoch 98 starting the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,708] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 98 for partition 789111199-0 (last update controller epoch 98) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:58:18,709] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 98 for partition node-test-0 (last update controller epoch 98) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:58:18,709] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 98 for partition 7891111-0 (last update controller epoch 98) since it is already the leader for the partition. (state.change.logger)
[2017-12-06 11:58:18,709] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 98 for the become-leader transition for partition 789111199-0 (state.change.logger)
[2017-12-06 11:58:18,709] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 98 for the become-leader transition for partition node-test-0 (state.change.logger)
[2017-12-06 11:58:18,709] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 3 from controller 0 epoch 98 for the become-leader transition for partition 7891111-0 (state.change.logger)
[2017-12-06 11:58:18,711] TRACE [Controller id=0 epoch=98] Received response {error_code=0,partitions=[{topic=789111199,partition=0,error_code=0},{topic=7891111,partition=0,error_code=0},{topic=node-test,partition=0,error_code=0}]} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 11:58:18,712] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) for partition 789111199-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 4 (state.change.logger)
[2017-12-06 11:58:18,712] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) for partition 7891111-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 4 (state.change.logger)
[2017-12-06 11:58:18,714] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=98, leader=0, leaderEpoch=97, isr=[0], zkVersion=97, replicas=[0], offlineReplicas=[]) for partition node-test-0 in response to UpdateMetadata request sent by controller 0 epoch 98 with correlation id 4 (state.change.logger)
[2017-12-06 11:58:18,714] TRACE [Controller id=0 epoch=98] Received response {error_code=0} for a request sent to broker 100.124.193.25:9092 (id: 0 rack: null) (state.change.logger)
